{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\rudiejd\\\\Documents\\\\crowdrec\\\\app\\\\src\\\\components\\\\SpotifyAuth.js\";\nimport React, { Component } from 'react';\nimport { Button } from 'react-bootstrap';\nimport { connect } from 'react-redux';\nexport const authEndpoint = 'https://accounts.spotify.com/authorize';\n\nclass SpotifyAuth extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      isAuthenticatedWithSpotify: false // menu: this.props.userId.menu\n\n    };\n    this.state.handleRedirect = this.handleRedirect.bind(this);\n  }\n\n  generateRandomString(length) {\n    let text = '';\n    const possible = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n    for (let i = 0; i < length; i++) {\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\n    }\n\n    return text;\n  }\n\n  getHashParams() {\n    const hashParams = {};\n    const r = /([^&;=]+)=?([^&;]*)/g;\n    const q = window.location.hash.substring(1);\n    let e = r.exec(q);\n\n    while (e) {\n      hashParams[e[1]] = decodeURIComponent(e[2]);\n      e = r.exec(q);\n    }\n\n    return hashParams;\n  }\n\n  componentDidMount() {\n    const params = this.getHashParams();\n    const access_token = params.access_token;\n    console.log(access_token);\n    this.props.change({\n      name: 'token',\n      value: access_token\n    });\n    const state = params.state;\n    const storedState = localStorage.getItem('stateKey');\n    localStorage.setItem('spotifyAuthToken', access_token);\n    localStorage.getItem('spotifyAuthToken');\n\n    if (window.localStorage.getItem('authToken')) {\n      this.setState({\n        isAuthenticatedWithSpotify: true\n      });\n    }\n\n    if (access_token && (state == null || state !== storedState)) {\n      alert('Click \"ok\" to finish authentication with Spotify');\n    } else {\n      localStorage.removeItem('stateKey');\n    } // handle token\n\n  }\n\n  handleRedirect(event) {\n    event.preventDefault();\n    console.log('You linked your Spotify account!', 'success');\n    const params = this.getHashParams();\n    const access_token = params.access_token;\n    this.props.change({\n      name: 'token',\n      value: access_token\n    });\n    const state = this.generateRandomString(16);\n    localStorage.setItem('stateKey', state);\n    let url = 'https://accounts.spotify.com/authorize' + '?response_type=code' + '&client_id=3f31f6d13b974219a7093698a47d76f9' + '&scope=' + encodeURIComponent('user-read-private%20user-read-email') + '&redirect_uri=' + encodeURIComponent('http://localhost:3000');\n    window.location = url;\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(Button, {\n      className: \"sp_button\",\n      onClick: event => this.handleRedirect(event),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 9\n      }\n    }, \"Link spotify to get started\");\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    vars: state.vars\n  };\n}; // mapping the dispatches from our reducer to box props \n\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    change: vName => dispatch({\n      type: 'CHANGE',\n      name: vName\n    })\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SpotifyAuth);","map":{"version":3,"sources":["C:/Users/rudiejd/Documents/crowdrec/app/src/components/SpotifyAuth.js"],"names":["React","Component","Button","connect","authEndpoint","SpotifyAuth","constructor","props","state","isAuthenticatedWithSpotify","handleRedirect","bind","generateRandomString","length","text","possible","i","charAt","Math","floor","random","getHashParams","hashParams","r","q","window","location","hash","substring","e","exec","decodeURIComponent","componentDidMount","params","access_token","console","log","change","name","value","storedState","localStorage","getItem","setItem","setState","alert","removeItem","event","preventDefault","url","encodeURIComponent","render","mapStateToProps","vars","mapDispatchToProps","dispatch","vName","type"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport {Button} from 'react-bootstrap';\r\nimport {connect} from 'react-redux';\r\n\r\nexport const authEndpoint = 'https://accounts.spotify.com/authorize';\r\nclass SpotifyAuth extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      isAuthenticatedWithSpotify: false\r\n      // menu: this.props.userId.menu\r\n    };\r\n    this.state.handleRedirect = this.handleRedirect.bind(this);\r\n  }\r\n\r\n  generateRandomString(length) {\r\n    let text = '';\r\n    const possible =\r\n      'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\r\n    for (let i = 0; i < length; i++) {\r\n      text += possible.charAt(Math.floor(Math.random() * possible.length));\r\n    }\r\n    return text;\r\n  }\r\n\r\n  getHashParams() {\r\n    const hashParams = {};\r\n    const r = /([^&;=]+)=?([^&;]*)/g;\r\n    const q = window.location.hash.substring(1);\r\n    let e = r.exec(q);\r\n    while (e) {\r\n      hashParams[e[1]] = decodeURIComponent(e[2]);\r\n      e = r.exec(q);\r\n    }\r\n    return hashParams;\r\n  }\r\n\r\n  componentDidMount() {\r\n    const params = this.getHashParams();\r\n\r\n    const access_token = params.access_token;\r\n    console.log(access_token);\r\n    this.props.change({name: 'token', value: access_token});\r\n    const state = params.state;\r\n    const storedState = localStorage.getItem('stateKey');\r\n    localStorage.setItem('spotifyAuthToken', access_token);\r\n    localStorage.getItem('spotifyAuthToken');\r\n\r\n    if (window.localStorage.getItem('authToken')) {\r\n      this.setState({ isAuthenticatedWithSpotify: true });\r\n    }\r\n    if (access_token && (state == null || state !== storedState)) {\r\n      alert('Click \"ok\" to finish authentication with Spotify');\r\n    } else {\r\n      localStorage.removeItem('stateKey');\r\n    }\r\n    // handle token\r\n    \r\n    \r\n  }\r\n\r\n  handleRedirect(event) {\r\n    event.preventDefault();\r\n    console.log('You linked your Spotify account!', 'success');\r\n\r\n    const params = this.getHashParams();\r\n    const access_token = params.access_token;\r\n    this.props.change({name: 'token', value: access_token});\r\n    \r\n\r\n    const state = this.generateRandomString(16);\r\n    localStorage.setItem('stateKey', state);\r\n\r\n    let url =\r\n      'https://accounts.spotify.com/authorize' +    \r\n      '?response_type=code' +\r\n      '&client_id=3f31f6d13b974219a7093698a47d76f9' +\r\n      '&scope=' +\r\n      encodeURIComponent('user-read-private%20user-read-email') +\r\n      '&redirect_uri=' +\r\n      encodeURIComponent('http://localhost:3000');\r\n    window.location = url;\r\n  }\r\n\r\n  render() {\r\n    return (\r\n\r\n        <Button className=\"sp_button\" onClick={(event) => this.handleRedirect(event)} >\r\n          Link spotify to get started\r\n        </Button>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n      vars:state.vars\r\n    }\r\n  };\r\n  \r\n  // mapping the dispatches from our reducer to box props \r\n  const mapDispatchToProps = (dispatch) => {\r\n    return {\r\n      change: (vName) => dispatch( {type: 'CHANGE', name: vName} ),\r\n  \r\n    }\r\n  \r\n  }\r\n\r\nexport default connect(mapStateToProps, mapDispatchToProps)(SpotifyAuth);"]},"metadata":{},"sourceType":"module"}